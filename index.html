<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>é¦–ç›¸å€™è£œ å›³é‘‘ï¼†ãƒãƒˆãƒ«ï¼ˆãƒã‚±ãƒ¢ãƒ³é¢¨ãƒ»å‰µä½œï¼‰</title>

  <!-- Tailwind CSSï¼ˆPlay CDNï¼‰: æ‰‹æ—©ããƒ‡ã‚¶ã‚¤ãƒ³ã‚’æ•´ãˆã‚‹ãŸã‚ã®CSSãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* ãµã‚ã£ã¨ä¸Šä¸‹ã«æºã‚Œã‚‹ç°¡æ˜“ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆFrameræœªä½¿ç”¨ã®ç´”CSSï¼‰ */
    @keyframes floatY { 0%{transform:translateY(0)} 50%{transform:translateY(-6px)} 100%{transform:translateY(0)} }
    .floaty { animation: floatY 4s ease-in-out infinite; }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-b from-slate-50 to-white text-slate-900">
  <header class="sticky top-0 z-10 border-b border-slate-200 backdrop-blur supports-[backdrop-filter]:bg-white/70">
    <div class="mx-auto max-w-6xl px-4 py-3">
      <div class="flex flex-col gap-3 md:flex-row md:items-end md:justify-between">
        <div>
          <h1 class="text-2xl font-bold tracking-tight">é¦–ç›¸å€™è£œ å›³é‘‘ï¼ˆãƒã‚±ãƒ¢ãƒ³é¢¨ï¼‰</h1>
          <p class="text-sm text-slate-600">â€»å‰µä½œã€‚äººç‰©è©•ä¾¡ã®æ–­å®šã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚æ•°å€¤ãƒ»ç›¸æ€§ã¯ãƒ•ã‚£ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚</p>
        </div>
        <div class="flex flex-wrap items-center gap-2">
          <input id="q" placeholder="åå‰ã§æ¤œç´¢" class="w-48 rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm shadow-sm outline-none focus:ring-2 focus:ring-slate-400" />
          <select id="typeFilter" class="rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm shadow-sm focus:ring-2 focus:ring-slate-400"></select>
          <select id="sortSel" class="rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm shadow-sm focus:ring-2 focus:ring-slate-400">
            <option value="no">ç•ªå·é †</option>
            <option value="name">åå‰é †</option>
          </select>
        </div>
      </div>
    </div>
  </header>

  <main class="mx-auto max-w-6xl px-4 py-8">
    <!-- å›³é‘‘ã‚«ãƒ¼ãƒ‰ã‚’ä¸¦ã¹ã‚‹é ˜åŸŸ -->
    <div id="cards" class="grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3"></div>
    <p id="emptyMsg" class="hidden mt-8 text-center text-slate-600">è©²å½“ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>

    <!-- ãƒãƒˆãƒ«ã‚¨ãƒªã‚¢ -->
    <section class="mt-10 rounded-2xl border border-slate-200 bg-white p-4">
      <h2 class="mb-3 text-base font-semibold">ãƒãƒˆãƒ«</h2>
      <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
        <!-- å·¦å´ï¼ˆãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼1ï¼‰ -->
        <div class="rounded-xl border border-slate-200 p-3">
          <div class="mb-2"><select id="selP1" class="w-full rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm shadow-sm"></select></div>
          <div class="flex items-center gap-3">
            <div id="ava1" class="floaty h-24 w-24"></div>
            <div class="w-full">
              <div class="flex items-center justify-between text-sm"><span id="name1" class="font-medium"></span><span><span id="hp1">100</span>/100</span></div>
              <div class="h-2 w-full rounded bg-slate-200"><div id="hpbar1" class="h-2 rounded bg-emerald-500" style="width:100%"></div></div>
            </div>
          </div>
          <div id="moves1" class="mt-3 grid grid-cols-2 gap-2"></div>
        </div>
        <!-- å³å´ï¼ˆãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼2ï¼‰ -->
        <div class="rounded-xl border border-slate-200 p-3">
          <div class="mb-2"><select id="selP2" class="w-full rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm shadow-sm"></select></div>
          <div class="flex items-center gap-3">
            <div id="ava2" class="floaty h-24 w-24"></div>
            <div class="w-full">
              <div class="flex items-center justify-between text-sm"><span id="name2" class="font-medium"></span><span><span id="hp2">100</span>/100</span></div>
              <div class="h-2 w-full rounded bg-slate-200"><div id="hpbar2" class="h-2 rounded bg-emerald-500" style="width:100%"></div></div>
            </div>
          </div>
          <div id="moves2" class="mt-3 grid grid-cols-2 gap-2"></div>
        </div>
      </div>
      <div class="mt-4 flex flex-wrap items-center gap-2">
        <button id="resetBtn" class="rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm shadow-sm">ãƒªã‚»ãƒƒãƒˆ</button>
        <span id="turnLbl" class="text-sm text-slate-600"></span>
      </div>
      <div id="log" class="mt-3 max-h-40 overflow-auto rounded-xl border border-slate-200 bg-gray-50 p-2 text-sm text-slate-800">
        <div class="text-slate-500">ãƒ­ã‚°ã¯ã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</div>
      </div>
    </section>

    <section class="mt-10 rounded-2xl border border-slate-200 bg-white p-4 text-sm leading-6 text-slate-700">
      <h2 class="mb-1 text-base font-semibold">æ³¨æ„</h2>
      <ul class="list-disc pl-5">
        <li>ã“ã®ãƒšãƒ¼ã‚¸ã¯å‰µä½œã®UIè¡¨ç¾ã§ã™ã€‚æ•°å€¤ãƒ»ç›¸æ€§ã¯ãƒ•ã‚£ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚</li>
        <li>æœ€æ–°ã®æ”¿æ²»å‹•å‘ã¯ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’ã”ç¢ºèªãã ã•ã„ã€‚</li>
      </ul>
    </section>
  </main>

  <footer class="mx-auto max-w-6xl px-4 py-12 text-center text-xs text-slate-500">Â© <span id="yy"></span> Poke-Style Dex (fictional)</footer>

  <script>
  // ======================== ãƒ‡ãƒ¼ã‚¿å®šç¾© ========================
  // ã‚¿ã‚¤ãƒ—ã«å¯¾å¿œã™ã‚‹è‰²ï¼ˆTailwindã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚¯ãƒ©ã‚¹ã‚’æŸã­ã‚‹ï¼‰
  const TYPE_COLORS = {
    "ã›ã„ã˜": "bg-indigo-200 border-indigo-400",
    "ã‘ã„ã–ã„": "bg-emerald-200 border-emerald-400",
    "ã—ã‚ƒã‹ã„": "bg-rose-200 border-rose-400",
    "ã¼ã†ãˆã„": "bg-yellow-200 border-yellow-400",
    "ã¼ã†ãˆã": "bg-sky-200 border-sky-400",
    "ãã‚‡ã†ã‚": "bg-purple-200 border-purple-400",
  };

  // ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã®5èƒ½åŠ›ã‚­ãƒ¼
  const STAT_KEYS = [
    { key: "lead", label: "ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—" },
    { key: "explain", label: "èª¬æ˜åŠ›" },
    { key: "negotiate", label: "äº¤æ¸‰åŠ›" },
    { key: "execute", label: "å®Ÿè¡ŒåŠ›" },
    { key: "crisis", label: "å±æ©Ÿå¯¾å¿œ" },
  ];

  // å›³é‘‘ã¨ãƒãƒˆãƒ«ã§ä½¿ã†å€™è£œãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ•ã‚£ã‚¯ã‚·ãƒ§ãƒ³ï¼‰
  const CANDIDATES = [
    { no:1, name:"å°æ³‰ é€²æ¬¡éƒ", kana:"ã“ã„ãšã¿ ã—ã‚“ã˜ã‚ã†", emoji:"ğŸŒ±", types:["ã›ã„ã˜","ã‘ã„ã–ã„"],
      height:"1.78mï¼ˆã‚¤ãƒ¡ãƒ¼ã‚¸ï¼‰", weight:"â€”", ability:"ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚°",
      dex:"ã‚ã‹ã‚Šã‚„ã™ã„è¨€è‘‰ã§äººã‚’å‹•ã‹ã™ã€‚ç’°å¢ƒã‚„å®¶è¨ˆã®ãƒãƒ©ãƒ³ã‚¹ã‚’æ„è­˜ã—ã¦æˆ¦ã†ã€‚",
      moves:[
        { name:"ãƒ“ã‚¸ãƒ§ãƒ³å…±æœ‰", desc:"æ–¹å‘æ€§ã‚’ç«¯çš„ã«ç¤ºã—å£«æ°—ã‚’ä¸Šã’ã‚‹ã€‚", power:70, accuracy:95 },
        { name:"å¯¾è©±", desc:"å¤šæ§˜ãªç«‹å ´ã‚’èã„ã¦å¦¥å”ç‚¹ã‚’æ¢ã™ã€‚", power:55, accuracy:100 },
        { name:"èª¿æ•´", desc:"éƒ¨é–€é–“ã®æ‘©æ“¦ã‚’ã‚„ã‚ã‚‰ã’å‰é€²ã•ã›ã‚‹ã€‚", power:60, accuracy:95 },
        { name:"å®¶è¨ˆã‚±ã‚¢", desc:"è² æ‹…æ„Ÿã‚’ä¸‹ã’ã‚‹æ–½ç­–ã§æ”¯æŒã‚’é›†ã‚ã‚‹ã€‚", power:65, accuracy:90 },
      ],
      stats:{ lead:82, explain:88, negotiate:74, execute:68, crisis:63 }, strong:["ã—ã‚ƒã‹ã„"], weak:["ã¼ã†ãˆã„"] },
    { no:2, name:"é«˜å¸‚ æ—©è‹—", kana:"ãŸã‹ã„ã¡ ã•ãªãˆ", emoji:"âš¡", types:["ã›ã„ã˜","ã¼ã†ãˆã„"],
      height:"â€”", weight:"â€”", ability:"ãƒ–ãƒ¬ãªã„è»¸",
      dex:"å®‰å…¨ä¿éšœã¨æˆé•·æˆ¦ç•¥ã‚’å‰ã«é€²ã‚ã‚‹ã€‚æ±ºæ–­ãŒé€Ÿã„ã€‚",
      moves:[
        { name:"æ–¹é‡æ˜ç¤º", desc:"å„ªå…ˆé †ä½ã‚’æ˜ç¢ºåŒ–ã—è¿·ã„ã‚’æ–­ã¤ã€‚", power:75, accuracy:95 },
        { name:"è¿…é€Ÿå¯¾å¿œ", desc:"åˆå‹•ã‚’æ—©ã‚ã¦æ··ä¹±ã‚’æŠ‘ãˆã‚‹ã€‚", power:70, accuracy:90 },
        { name:"ç™ºä¿¡åŠ›", desc:"æƒ…å ±ã‚’åºƒãå±Šã‘æ”¯æŒã‚’å›ºã‚ã‚‹ã€‚", power:65, accuracy:95 },
        { name:"ã‚µãƒ—ãƒ©ã‚¤å¼·åŒ–", desc:"ä¾›çµ¦ç¶²ã®è€æ€§ã‚’ä¸Šã’ã‚‹ã€‚", power:62, accuracy:90 },
      ],
      stats:{ lead:86, explain:76, negotiate:68, execute:84, crisis:88 }, strong:["ã¼ã†ãˆã„"], weak:["ã—ã‚ƒã‹ã„"] },
    { no:3, name:"æ— èŠ³æ­£", kana:"ã¯ã‚„ã— ã‚ˆã—ã¾ã•", emoji:"ğŸ§­", types:["ã›ã„ã˜","ã¼ã†ãˆã"],
      height:"â€”", weight:"â€”", ability:"ã‹ã˜å–ã‚Š",
      dex:"å®‰å®šæ„Ÿã®ã‚ã‚‹èˆµå–ã‚Šã§å†…å¤–ã®åˆ©å®³ã‚’æ•´ãˆã‚‹ã€‚",
      moves:[
        { name:"åˆæ„å½¢æˆ", desc:"é–¢ä¿‚è€…ã‚’å·»ãè¾¼ã‚“ã§åã‚Œã‚“ã€‚", power:72, accuracy:95 },
        { name:"ä¸å¯§ãªèª¬æ˜", desc:"ç´å¾—æ„Ÿã‚’é«˜ã‚åç™ºã‚’æ¸›ã‚‰ã™ã€‚", power:60, accuracy:100 },
        { name:"å›½éš›é€£æº", desc:"åŒç›Ÿãƒ»è¿‘éš£ã¨èª¿å’Œã‚’å›³ã‚‹ã€‚", power:68, accuracy:95 },
        { name:"å·¥ç¨‹ç®¡ç†", desc:"æ®µå–ã‚Šè‰¯ãå®Ÿè£…ã‚’é€²ã‚ã‚‹ã€‚", power:58, accuracy:95 },
      ],
      stats:{ lead:78, explain:85, negotiate:82, execute:73, crisis:70 }, strong:["ã¼ã†ãˆã"], weak:["ã‘ã„ã–ã„"] },
    { no:4, name:"å°æ— é·¹ä¹‹", kana:"ã“ã°ã‚„ã— ãŸã‹ã‚†ã", emoji:"ğŸ›¡ï¸", types:["ã›ã„ã˜","ã—ã‚ƒã‹ã„"],
      height:"â€”", weight:"â€”", ability:"æ”¿ç­–è¨­è¨ˆ",
      dex:"åˆ¶åº¦è¨­è¨ˆã«å¼·ãã€æš®ã‚‰ã—ã®å®‰å¿ƒã‚’é«˜ã‚ã‚‹æ‰‹ã‚’æ‰“ã¤ã€‚",
      moves:[
        { name:"åˆ¶åº¦è¦‹ç›´ã—", desc:"å¤ã„ä»•çµ„ã¿ã‚’ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã€‚", power:66, accuracy:95 },
        { name:"ãƒ«ãƒ¼ãƒ«ç­–å®š", desc:"æŠœã‘ç©´ã‚’å¡ãå…¬å¹³æ€§ã‚’ä¸Šã’ã‚‹ã€‚", power:62, accuracy:95 },
        { name:"èª²é¡ŒæŠ½å‡º", desc:"å®Ÿè£…å‰ã«ãƒªã‚¹ã‚¯ã‚’æ´—ã„å‡ºã™ã€‚", power:55, accuracy:100 },
        { name:"åœ°åŸŸã‚±ã‚¢", desc:"ç¾å ´ã®å›°ã‚Šã”ã¨ã«å¯„ã‚Šãã†ã€‚", power:60, accuracy:95 },
      ],
      stats:{ lead:72, explain:74, negotiate:69, execute:77, crisis:71 }, strong:["ã—ã‚ƒã‹ã„"], weak:["ã¼ã†ãˆã"] },
    { no:5, name:"èŒ‚æœ¨ æ•å……", kana:"ã‚‚ã¦ã ã¨ã—ã¿ã¤", emoji:"ğŸŒ", types:["ã›ã„ã˜","ã¼ã†ãˆã"],
      height:"â€”", weight:"â€”", ability:"ãƒã‚´ã‚·ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³",
      dex:"äº¤æ¸‰ã¨å®Ÿå‹™ã«é•·ã‘ã€åˆæ„ã‚’ã¾ã¨ã‚ã¦å‰ã«é€²ã‚ã‚‹ã€‚",
      moves:[
        { name:"äº¤æ¸‰", desc:"åˆ©å®³ã®æŠ˜ã‚Šåˆã„ã‚’ã¤ã‘ã‚‹ã€‚", power:78, accuracy:95 },
        { name:"è½ã¨ã—æ‰€", desc:"ç¾å®Ÿçš„ãªè§£ã‚’è¦‹ã¤ã‘ã‚‹ã€‚", power:70, accuracy:95 },
        { name:"å®Ÿè¡Œç®¡ç†", desc:"æ±ºã‚ãŸã“ã¨ã‚’ç¢ºå®Ÿã«å›ã™ã€‚", power:73, accuracy:95 },
        { name:"å›½éš›æ çµ„ã¿", desc:"å¤šå›½é–“ã§ã®æ•´åˆã‚’å–ã‚‹ã€‚", power:68, accuracy:90 },
      ],
      stats:{ lead:80, explain:77, negotiate:90, execute:82, crisis:75 }, strong:["ã¼ã†ãˆã"], weak:["ã—ã‚ƒã‹ã„"] },
  ];

  // ======================== å…±é€šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ ========================
  // ç¨®å­ä»˜ãã®ç°¡æ˜“ä¹±æ•°ï¼ˆä½ãƒãƒªå¤šè§’å½¢ã®å½¢ã‚’å€‹ä½“ã”ã¨ã«å®‰å®šã•ã›ã‚‹ï¼‰
  function seededRand(seed, i) {
    const x = Math.sin(seed * 999 + i * 77) * 10000; // Math.sinã§æ“¬ä¼¼ä¹±æ•°æº
    return x - Math.floor(x); // 0ã€œ1æœªæº€
  }

  // ä½ãƒãƒªã‚´ãƒ³é¢¨ã‚¢ãƒã‚¿ãƒ¼ã‚’SVGæ–‡å­—åˆ—ã¨ã—ã¦ç”Ÿæˆ
  function renderLowPoly(seed, emoji) {
    // 8é ‚ç‚¹ã®å¤šè§’å½¢ã‚’å††å‘¨ä¸Šã«é…ç½®ã—ã€åŠå¾„ã‚’seededRandã§ã‚†ã‚‰ã™
    const pts = Array.from({length:8}).map((_,i)=>{
      const ang = (i/8) * Math.PI*2;
      const r = 36 + seededRand(seed,i) * 22; // åŠå¾„ã‚’36ã€œ58ã«ã‚†ã‚‰ã™
      const x = 50 + Math.cos(ang) * r;
      const y = 50 + Math.sin(ang) * r;
      return `${x},${y}`;
    }).join(' ');
    // ã‚°ãƒ©ãƒ‡ã¨å¤šè§’å½¢ã€ä¸­å¤®ã«çµµæ–‡å­—
    return `\n<svg viewBox="0 0 100 100" class="h-full w-full">\n  <defs>\n    <linearGradient id="grad-${seed}" x1="0" x2="1" y1="0" y2="1">\n      <stop offset="0%" stop-color="#c7d2fe"/>\n      <stop offset="100%" stop-color="#a7f3d0"/>\n    </linearGradient>\n  </defs>\n  <polygon points="${pts}" fill="url(#grad-${seed})" stroke="#334155" stroke-width="1.2"/>\n  <text x="50" y="54" font-size="22" text-anchor="middle" dominant-baseline="middle">${emoji}</text>\n</svg>`;
  }

  // ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆSVGã‚’ç”Ÿæˆï¼ˆäº”è§’å½¢ï¼‰ï¼šå„èƒ½åŠ›(0-100)ã‚’åŠå¾„70ã«æ­£è¦åŒ–
  function renderRadar(stats) {
    const size = 160, center = size/2, radius = 70;
    const toPoint = (idx, value)=>{
      const angle = (-90 + (360/STAT_KEYS.length)*idx) * (Math.PI/180); // ä¸Šã‹ã‚‰é–‹å§‹
      const r = (value/100) * radius;
      const x = center + Math.cos(angle)*r;
      const y = center + Math.sin(angle)*r;
      return `${x},${y}`;
    };
    // å¡—ã‚Šã¤ã¶ã—å¤šè§’å½¢
    const poly = STAT_KEYS.map((s,i)=>toPoint(i, stats[s.key])).join(' ');
    // è£œåŠ©ã‚°ãƒªãƒƒãƒ‰ï¼ˆ20åˆ»ã¿ï¼‰
    const grid = [20,40,60,80,100].map(v=>
      `<polygon points="${STAT_KEYS.map((_,i)=>toPoint(i,v)).join(' ')}" class="fill-none" stroke="#e2e8f0"/>`
    ).join('');
    // ãƒ©ãƒ™ãƒ«
    const labels = STAT_KEYS.map((s,i)=>{
      const [x,y] = toPoint(i,110).split(',');
      return `<text x="${x}" y="${y}" class="text-[10px]" fill="#475569" text-anchor="middle">${s.label}</text>`;
    }).join('');
    return `<svg viewBox="0 0 ${size} ${size}" class="h-44 w-44">${grid}<polygon points="${poly}" fill="rgba(199,210,254,0.6)" stroke="#818cf8"/>${labels}</svg>`;
  }

  // ã‚¿ã‚¤ãƒ—ãƒãƒƒã‚¸
  function typeBadge(t){
    const cls = TYPE_COLORS[t] || "bg-gray-200 border-gray-300";
    return `<span class="border ${cls} text-gray-900 text-xs px-2 py-0.5 rounded-full">${t}</span>`;
  }

  // å°ã•ãªãƒãƒƒãƒ—
  const pill = (txt)=>`<span class="rounded-full bg-gray-100 px-2 py-1 text-xs">${txt}</span>`;

  // ======================== å›³é‘‘ã®æç”» ========================
  const cardsEl = document.getElementById('cards');
  const emptyMsg = document.getElementById('emptyMsg');
  const qEl = document.getElementById('q');
  const typeSel = document.getElementById('typeFilter');
  const sortSel = document.getElementById('sortSel');

  // ã‚¿ã‚¤ãƒ—ã®é¸æŠè‚¢ã‚’åˆæœŸåŒ–ï¼ˆ"ã™ã¹ã¦" + å‡ºç¾ã‚¿ã‚¤ãƒ—ã®é›†åˆï¼‰
  (function initTypeOptions(){
    const set = new Set();
    CANDIDATES.forEach(c=>c.types.forEach(t=>set.add(t)));
    typeSel.innerHTML = `<option value="ã™ã¹ã¦">ã™ã¹ã¦</option>` + Array.from(set).map(t=>`<option value="${t}">${t}</option>`).join('');
  })();

  // å›³é‘‘ã‚«ãƒ¼ãƒ‰1æšã‚’HTMLã§ç”Ÿæˆ
  function renderCard(c){
    return `
    <div class="group relative overflow-hidden rounded-2xl border border-gray-200 bg-white/80 p-4 shadow-sm transition">
      <div class="flex items-start gap-3">
        <div class="floaty h-24 w-24">${renderLowPoly(c.no, c.emoji)}</div>
        <div class="min-w-0">
          <div class="flex items-center gap-2">
            <div class="text-xs text-gray-500">No.${String(c.no).padStart(3,'0')}</div>
            <div class="flex gap-1">${c.types.map(typeBadge).join('')}</div>
          </div>
          <h3 class="mt-1 text-lg font-semibold leading-tight">${c.name}<span class="ml-2 text-sm text-gray-500">${c.kana}</span></h3>
          <p class="mt-1 text-sm text-gray-700">${c.dex}</p>
        </div>
      </div>
      <div class="mt-3 grid grid-cols-1 gap-3 md:grid-cols-2">
        <dl class="grid grid-cols-3 gap-2 text-xs text-gray-700">
          <div class="rounded-lg bg-gray-50 p-2"><dt class="text-gray-500">ã¨ãã›ã„</dt><dd class="font-medium">${c.ability}</dd></div>
          <div class="rounded-lg bg-gray-50 p-2"><dt class="text-gray-500">é«˜ã•</dt><dd class="font-medium">${c.height}</dd></div>
          <div class="rounded-lg bg-gray-50 p-2"><dt class="text-gray-500">é‡ã•</dt><dd class="font-medium">${c.weight}</dd></div>
          <div class="col-span-3 rounded-lg bg-gray-50 p-2">
            <dt class="text-gray-500">ç›¸æ€§</dt>
            <dd class="mt-1 flex flex-wrap gap-1">${c.strong.map(t=>pill(`å¾—æ„: ${t}`)).join('')}${c.weak.map(t=>pill(`å¼±ç‚¹: ${t}`)).join('')}</dd>
          </div>
        </dl>
        <div class="flex items-center justify-center">${renderRadar(c.stats)}</div>
      </div>
      <div class="mt-3">
        <div class="mb-1 text-sm font-semibold text-slate-700">ãŠã¼ãˆã‚‹ã‚ã–</div>
        <div class="mt-2 grid grid-cols-1 gap-2 sm:grid-cols-2">
          ${c.moves.map(m=>`
            <div class="rounded-xl border border-slate-200 bg-white p-2 text-xs">
              <div class="font-medium">${m.name}</div>
              <div class="mt-0.5 text-slate-600">${m.desc}</div>
              <div class="mt-1 flex gap-2 text-slate-500">${pill(`å¨åŠ› ${m.power}`)}${pill(`å‘½ä¸­ ${m.accuracy}%`)}</div>
            </div>`).join('')}
        </div>
      </div>
    </div>`;
  }

  // å›³é‘‘ã®å†æç”»ï¼ˆæ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ»ã‚½ãƒ¼ãƒˆã‚’åæ˜ ï¼‰
  function redrawDex(){
    const key = qEl.value.trim();
    const type = typeSel.value;
    const sort = sortSel.value;
    // ãƒ•ã‚£ãƒ«ã‚¿æ¡ä»¶ï¼šåå‰ã¾ãŸã¯ã‹ãªã«éƒ¨åˆ†ä¸€è‡´ã€ã‚¿ã‚¤ãƒ—ä¸€è‡´ï¼ˆ"ã™ã¹ã¦"ã¯ç„¡æ¡ä»¶ï¼‰
    let arr = CANDIDATES.filter(c=>{
      const okName = [c.name, c.kana].some(v=>v.includes(key));
      const okType = (type === 'ã™ã¹ã¦') || c.types.includes(type);
      return (key==='' || okName) && okType;
    });
    // ã‚½ãƒ¼ãƒˆï¼šç•ªå· or åå‰
    if (sort === 'name') arr = [...arr].sort((a,b)=>a.name.localeCompare(b.name,'ja'));
    if (sort === 'no')   arr = [...arr].sort((a,b)=>a.no - b.no);
    // DOMåæ˜ 
    cardsEl.innerHTML = arr.map(renderCard).join('');
    emptyMsg.classList.toggle('hidden', arr.length !== 0);
  }

  // å…¥åŠ›ã‚¤ãƒ™ãƒ³ãƒˆã§éƒ½åº¦å†æç”»
  qEl.addEventListener('input', redrawDex);
  typeSel.addEventListener('change', redrawDex);
  sortSel.addEventListener('change', redrawDex);

  // åˆå›æç”»
  redrawDex();

  // ======================== ãƒãƒˆãƒ«æ©Ÿèƒ½ ========================
  // çŠ¶æ…‹ï¼ˆç°¡æ˜“ï¼‰ï¼šãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼1/2ã€HPã€ã‚¿ãƒ¼ãƒ³ã€çµ‚äº†ãƒ•ãƒ©ã‚°
  let p1 = CANDIDATES[0];
  let p2 = CANDIDATES[1] || CANDIDATES[0];
  let hp1 = 100, hp2 = 100;
  let turn = 1; // 1 or 2
  let ended = false;

  // ç›¸æ€§ï¼šæ”»æ’ƒå´ã‚¿ã‚¤ãƒ—ãŒç›¸æ‰‹ã®å¼±ç‚¹ãªã‚‰Ã—1.2ã€ç›¸æ‰‹ã®å¾—æ„ãªã‚‰Ã—0.8ï¼ˆã‚·ãƒ³ãƒ—ãƒ«ï¼‰
  function effectiveness(attacker, defender){
    let mult = 1.0; let label = '';
    attacker.types.forEach(t=>{
      if (defender.weak.includes(t)) { mult *= 1.2; label = 'ã“ã†ã‹ã¯ã°ã¤ãã‚“ï¼'; }
      if (defender.strong.includes(t)) { mult *= 0.8; label = 'ã„ã¾ã²ã¨ã¤â€¦'; }
    });
    return { mult, label };
  }

  // HPãƒãƒ¼è‰²ï¼ˆç·‘â†’é»„â†’èµ¤ï¼‰
  function hpColor(h){ return h>60? 'bg-emerald-500' : h>30? 'bg-amber-500' : 'bg-rose-500'; }

  // DOMå–å¾—ï¼ˆãƒãƒˆãƒ«ï¼‰
  const selP1 = document.getElementById('selP1');
  const selP2 = document.getElementById('selP2');
  const name1 = document.getElementById('name1');
  const name2 = document.getElementById('name2');
  const hp1El = document.getElementById('hp1');
  const hp2El = document.getElementById('hp2');
  const hpbar1 = document.getElementById('hpbar1');
  const hpbar2 = document.getElementById('hpbar2');
  const moves1 = document.getElementById('moves1');
  const moves2 = document.getElementById('moves2');
  const ava1 = document.getElementById('ava1');
  const ava2 = document.getElementById('ava2');
  const resetBtn = document.getElementById('resetBtn');
  const turnLbl = document.getElementById('turnLbl');
  const log = document.getElementById('log');

  // ã‚»ãƒ¬ã‚¯ãƒˆã®é¸æŠè‚¢ã‚’å€™è£œã§åŸ‹ã‚ã‚‹
  function initSelectors(){
    const opt = c => `<option value="${c.no}">${c.name}</option>`;
    selP1.innerHTML = CANDIDATES.map(opt).join('');
    selP2.innerHTML = CANDIDATES.map(opt).join('');
    selP1.value = p1.no; selP2.value = p2.no;
  }

  // å€™è£œãƒ‡ãƒ¼ã‚¿ã‹ã‚‰UIã‚’æ›´æ–°
  function syncUI(){
    name1.textContent = p1.name; name2.textContent = p2.name;
    hp1El.textContent = hp1; hp2El.textContent = hp2;
    hpbar1.style.width = hp1 + '%'; hpbar2.style.width = hp2 + '%';
    hpbar1.className = 'h-2 rounded ' + hpColor(hp1);
    hpbar2.className = 'h-2 rounded ' + hpColor(hp2);
    ava1.innerHTML = renderLowPoly(p1.no, p1.emoji);
    ava2.innerHTML = renderLowPoly(p2.no, p2.emoji);
    // æŠ€ãƒœã‚¿ãƒ³ä½œæˆï¼ˆè‡ªåˆ†ã®ã‚¿ãƒ¼ãƒ³ä»¥å¤–ã¯disabledï¼‰
    moves1.innerHTML = p1.moves.map(m=>`<button class="rounded-xl border border-slate-300 px-3 py-2 text-left text-sm ${turn!==1||ended?'opacity-50 pointer-events-none':''}" data-m="${m.name}"><div class="font-medium">${m.name}</div><div class="text-xs text-slate-500">å¨åŠ›${m.power} å‘½ä¸­${m.accuracy}%</div></button>`).join('');
    moves2.innerHTML = p2.moves.map(m=>`<button class="rounded-xl border border-slate-300 px-3 py-2 text-left text-sm ${turn!==2||ended?'opacity-50 pointer-events-none':''}" data-m="${m.name}"><div class="font-medium">${m.name}</div><div class="text-xs text-slate-500">å¨åŠ›${m.power} å‘½ä¸­${m.accuracy}%</div></button>`).join('');
    turnLbl.textContent = ended ? 'ãƒãƒˆãƒ«çµ‚äº†' : `ã‚¿ãƒ¼ãƒ³ï¼š${turn===1 ? p1.name : p2.name}`;
  }

  // ãƒ­ã‚°ã®å…ˆé ­ã«è¿½è¨˜
  function pushLog(text){
    const div = document.createElement('div');
    div.className = 'leading-6';
    div.textContent = `â€¢ ${text}`;
    // æœ€åˆã®ç©ºãƒ­ã‚°æ–‡ã‚’å‰Šé™¤
    const first = log.firstElementChild; if (first && first.classList.contains('text-slate-500')) first.remove();
    log.prepend(div);
  }

  // ãƒªã‚»ãƒƒãƒˆ
  function resetBattle(){ hp1=100; hp2=100; turn=1; ended=false; log.innerHTML = '<div class="text-slate-500">ãƒ­ã‚°ã¯ã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</div>'; syncUI(); }

  // ä¸ãƒ€ãƒ¡è¨ˆç®—ï¼š
  //  1) å‘½ä¸­åˆ¤å®šï¼ˆä¹±æ•°ï¼‰
  //  2) ç›¸æ€§å€ç‡ï¼ˆ1.2/0.8ï¼‰
  //  3) æ”»æ’ƒå´ = (äº¤æ¸‰åŠ›+å®Ÿè¡ŒåŠ›)/2ã€é˜²å¾¡å´ = å±æ©Ÿå¯¾å¿œ ã‚’ä¿‚æ•°åŒ–ã—ã€
  //  4) åŸºç¤å¨åŠ› Ã— æ”»æ’ƒä¿‚æ•° Ã— 0.6 - é˜²å¾¡ä¿‚æ•°Ã—0.2 ã‚’ãƒ™ãƒ¼ã‚¹ã«ã€æœ€ä½5ãƒ€ãƒ¡ä¿è¨¼
  function act(move){
    if (ended) return;
    const atk = (turn===1) ? p1 : p2;
    const def = (turn===1) ? p2 : p1;
    // å‘½ä¸­åˆ¤å®š
    if (Math.random()*100 >= move.accuracy){ pushLog(`${atk.name} ã®ã€Œ${move.name}ã€ã¯å¤–ã‚ŒãŸï¼`); turn = (turn===1)?2:1; syncUI(); return; }
    // ç›¸æ€§
    const { mult, label } = effectiveness(atk, def);
    // ã–ã£ãã‚Šèƒ½åŠ›åæ˜ 
    const atkStat = Math.round((atk.stats.negotiate + atk.stats.execute)/2);
    const defStat = Math.round(def.stats.crisis);
    const base = move.power * (atkStat/100) * 0.6;
    const dmg = Math.max(5, Math.round((base - defStat*0.2) * mult));
    if (turn===1){ hp2 = Math.max(0, hp2 - dmg); pushLog(`${atk.name} ã®ã€Œ${move.name}ã€ï¼ ${label} ${dmg}ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼`); if (hp2===0){ ended=true; } turn=2; }
    else { hp1 = Math.max(0, hp1 - dmg); pushLog(`${atk.name} ã®ã€Œ${move.name}ã€ï¼ ${label} ${dmg}ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼`); if (hp1===0){ ended=true; } turn=1; }
    syncUI();
  }

  // æŠ€ãƒœã‚¿ãƒ³ã®å§”è­²ã‚¯ãƒªãƒƒã‚¯ï¼ˆè¦ªè¦ç´ ã§æ‹¾ã†ï¼‰
  moves1.addEventListener('click', (e)=>{
    const btn = e.target.closest('button'); if (!btn) return;
    if (turn!==1 || ended) return;
    const mvName = btn.dataset.m; const mv = p1.moves.find(m=>m.name===mvName);
    act(mv);
  });
  moves2.addEventListener('click', (e)=>{
    const btn = e.target.closest('button'); if (!btn) return;
    if (turn!==2 || ended) return;
    const mvName = btn.dataset.m; const mv = p2.moves.find(m=>m.name===mvName);
    act(mv);
  });

  // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®åˆ‡ã‚Šæ›¿ãˆ
  selP1.addEventListener('change', ()=>{ p1 = CANDIDATES.find(c=>c.no==selP1.value); resetBattle(); });
  selP2.addEventListener('change', ()=>{ p2 = CANDIDATES.find(c=>c.no==selP2.value); resetBattle(); });
  resetBtn.addEventListener('click', resetBattle);

  // åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
  initSelectors();
  document.getElementById('yy').textContent = new Date().getFullYear();
  syncUI();
  </script>
</body>
</html>
